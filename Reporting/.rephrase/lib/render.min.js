"use strict";function getEntry(name){return $databank&&"object"==typeof $databank&&$databank.hasOwnProperty(name)?$databank[name]:{}}function getEntryName(name){return getEntry(name).Name||""}function getSeriesContent(name){const dataObj=getEntry(name);if(dataObj&&"object"==typeof dataObj&&dataObj.hasOwnProperty("Values")&&dataObj.Values instanceof Array&&dataObj.hasOwnProperty("Dates")){var dates=[];if(dataObj.Dates instanceof Array&&dataObj.Dates.length===dataObj.Values.length)dates=dataObj.Dates.map(function(d){return new Date(d)});else{const freqUnit=$ru.freqToUnit(dataObj.Frequency),startDate=new Date(dataObj.Dates instanceof Array?dataObj.Dates[0]:dataObj.Dates);for(var i=0;i<dataObj.Values.length;i++)dates.push(moment(startDate).add(i,freqUnit).toDate())}return{Values:dataObj.Values,Dates:dates}}return{}}var $ru={createChart:createChart,createChartContent:createChartContent,createChartSeries:createChartSeries,createChartCurve:createChartCurve,createChartBody:createChartBody,createSeries:createSeries,createSpreads:createSpreads,createTable:createTable,createTableSeries:createTableSeries,createGrid:createGrid,createPager:createPager,createMatrix:createMatrix,addReportElement:addReportElement,addPageBreak:addPageBreak,createWrapper:createWrapper,createTextBlock:createTextBlock,createSection:createSection,appendObjSettings:appendObjSettings,momentJsDateFormatToD3TimeFormat:momentJsDateFormatToD3TimeFormat,postProcessIrisCode:postProcessIrisCode,getElementIds:getElementIds,generateToc:generateToc,test:{nonemptyArray:x=>x instanceof Array&&x.length>0},printRgba:printRgba,whitenRgba:whitenRgba,colorScheme:{getColorList:getColorList},table:{printTableNumber:printTableNumber,createDifftableSeriesRow:createDifftableSeriesRow,evalConditionals:evalConditionals,getTableNumberClass:getTableNumberClass},databank:{getEntry:getEntry,getEntryName:getEntryName,getSeriesContent:getSeriesContent},getTitle:getTitle,addUserClass:addUserClass};const DEFAULT_MARKER_COLOR=[10,10,10,1],DEFAULT_HIGHLIGHT_FILLCOLOR=[100,100,100,.2],DEFAULT_SHOW_LEGEND=!0,DEFAULT_LINE_WIDTH=2,DEFAULT_NUM_DECIMALS=2,DEFAULT_HOVERFORMAT=".2r",DEFAULT_TEXT_POSITION="top",DIFF_METHOD={ratio:(x,y)=>x/y,percent:(x,y)=>100*(x/y-1),diff:(x,y)=>x-y},DIFF_SUFFIX={ratio:"",percent:"%",diff:""},DEFAULT_COLOR_SCHEME={ColorOrder:[[0,114,189,1],[217,83,25,1],[237,177,32,1],[126,47,142,1],[119,172,48,1],[77,190,238,1],[162,20,47,1]]};function createChart(parent,chartObj){let chartType=chartObj.Type.toLowerCase();const freq=chartObj.Settings.Frequency||0;"serieschart"===chartType&&0===freq&&(chartType="linearchart");var chartParent=document.createElement("div");$(chartParent).attr("id",chartObj.Id),$(chartParent).addClass("rephrase-chart"),chartObj.Settings.Class&&("string"==typeof chartObj.Settings.Class||chartObj.Settings.Class instanceof Array)&&$(chartParent).addClass(chartObj.Settings.Class),parent.appendChild(chartParent);const title=$ru.getTitle(chartObj);if(title){var chartTitleDiv=document.createElement("div");$(chartTitleDiv).addClass(["rephrase-chart-title","h4"]),chartTitleDiv.innerText=title,chartParent.appendChild(chartTitleDiv)}let data=[],ticks={tickLabels:[],tickValues:[]},limits=[null,null];switch(chartType){case"serieschart":limits=[chartObj.Settings.StartDate?new Date(chartObj.Settings.StartDate):null,chartObj.Settings.EndDate?new Date(chartObj.Settings.EndDate):null];break;case"linearchart":limits=[chartObj.Settings.StartDate,chartObj.Settings.EndDate];break;case"curvechart":chartObj.Settings.hasOwnProperty("TickLabels")&&(ticks.tickLabels=chartObj.Settings.TickLabels),chartObj.Settings.hasOwnProperty("Ticks")&&(ticks.tickValues=chartObj.Settings.Ticks),limits=[0,ticks.tickValues instanceof Array&&ticks.tickValues.length?Math.max(...ticks.tickValues):null]}if(chartObj.hasOwnProperty("Content")&&chartObj.Content instanceof Array){const colorList=$ru.colorScheme.getColorList();let colorCounter=-1;for(let childObj of chartObj.Content){childObj.Settings=appendObjSettings(childObj.Settings||{},chartObj.Settings||{}),colorCounter=childObj.Settings.KeepColor?colorCounter:++colorCounter;const color=childObj.Settings.Color||colorList[colorCounter%colorList.length];if(childObj.Settings.Color=color,data.push($ru.createChartContent(childObj,freq,limits)),$ru.test.nonemptyArray(childObj.Settings.Bands))for(let bandsObj of childObj.Settings.Bands){const colorWhitened=$ru.whitenRgba(color,bandsObj.Settings.Whitening,bandsObj.Settings.Alpha);bandsObj.Settings.Color=colorWhitened,bandsObj.Settings.FillColor=colorWhitened,data.push($ru.createChartContent(bandsObj,freq,limits))}}}const chartBody=$ru.createChartBody(chartType,data,limits,chartObj.Settings,ticks);chartParent.appendChild(chartBody)}function createChartContent(contentObj,freq,limits){if(!contentObj||"object"!=typeof contentObj||!contentObj.hasOwnProperty("Type")||!contentObj.Type)return{};switch(contentObj.Type.toLowerCase()){case"curve":return $ru.createChartCurve(contentObj,limits);case"series":case"bands":return $ru.createChartSeries(contentObj,freq,limits);default:return{}}}function createChartCurve(curveObj,limits){if(!curveObj.hasOwnProperty("Content")||!("string"==typeof curveObj.Content||"object"==typeof curveObj.Content&&curveObj.Content.hasOwnProperty("Ticks")&&curveObj.Content.hasOwnProperty("Values")))return{};"string"==typeof curveObj.Content&&(curveObj.Content=$ru.databank.getEntry(curveObj.Content));let seriesObj=$ru.createSeries(curveObj.Title,curveObj.Content.Ticks,curveObj.Content.Values,curveObj.Settings,!1);return $ru.test.nonemptyArray(curveObj.Content.Spreads)&&(seriesObj.error_y=$ru.createSpreads(curveObj.Content.Spreads)),seriesObj}function createSpreads(spreadValues){return{type:"data",symmetric:!1,array:spreadValues,visible:!0}}function createChartSeries(seriesObj,freq,limits){if(!seriesObj.hasOwnProperty("Content")||!("string"==typeof seriesObj.Content||"object"==typeof seriesObj.Content&&seriesObj.Content.hasOwnProperty("Dates")&&seriesObj.Content.hasOwnProperty("Values")))return{};seriesObj.Settings;return"string"==typeof seriesObj.Content?seriesObj.Content=$ru.databank.getSeriesContent(seriesObj.Content):freq>0&&(seriesObj.Content.Dates=seriesObj.Content.Dates.map(function(d){return new Date(d)})),$ru.createSeries(seriesObj.Title,seriesObj.Content.Dates,seriesObj.Content.Values,seriesObj.Settings,!1)}function addPageBreak(parent,_breakObj){var pageBreakDiv=document.createElement("div");$(pageBreakDiv).attr("id",_breakObj.Id),$(pageBreakDiv).addClass("page-break"),pageBreakDiv.innerHTML="&nbsp;",parent.appendChild(pageBreakDiv)}function createChartBody(chartType,data,limits,settings,ticks){const dateFormat=settings.DateFormat||"",highlight=settings.Highlight||[],interactive=(settings.BarMode,!settings.hasOwnProperty("InteractiveCharts")||settings.InteractiveCharts);var chartBody=document.createElement("div");$(chartBody).addClass("rephrase-chart-body");const layout={showlegend:!!settings.hasOwnProperty("ShowLegend")&&settings.ShowLegend,font:{family:"Open Sans",color:"#0a0a0a",...settings.Layout.font},barmode:settings.BarMode||"group",xaxis:{type:"linear",dtick:null,xtick0:null,autorange:!1,rangemode:null,fixedrange:!1,gridcolor:"#dddddd",showline:!0,zeroline:!1,linecolor:"#aaaaaa",tickvals:null,ticktext:null,ticklabeloverflow:"hide past div",tickformat:"g",tickmode:"auto",tickangle:"auto",mirror:!0,...settings.Layout.xaxis},yaxis:{type:"linear",rangemode:"normal",autorange:!0,fixedrange:!1,tickformat:"g",hoverformat:".2r",gridcolor:"#dddddd",linecolor:"#aaaaaa",zeroline:!1,mirror:!0,showline:!0,...settings.Layout.yaxis},legend:{bgcolor:"transparent",x:.5,y:1.025,xanchor:"center",yanchor:"bottom",orientation:"h",...settings.Layout.legend},margin:{l:50,r:50,b:30,t:10,pad:4,...settings.Layout.margin},shapes:[]};switch(chartType){case"serieschart":layout.xaxis.type="date",layout.xaxis.tickformat=$ru.momentJsDateFormatToD3TimeFormat(dateFormat);break;case"linearchart":break;case"curvechart":layout.xaxis.tickmode="array",layout.yaxis.rangemode="tozero"}layout.xaxis.range=limits,layout.xaxis.tickvals=ticks.tickValues,layout.xaxis.ticktext=ticks.tickLabels;const config={responsive:!0,staticPlot:!interactive};if(layout.shapes instanceof Array||(layout.shapes=[]),$ru.test.nonemptyArray(highlight))for(let h of highlight){let shape={type:"rect",xref:"x",x0:h.StartDate||settings.StartDate,x1:h.EndDate||settings.EndDate,yref:"paper",y0:0,y1:1,fillcolor:$ru.printRgba(h.Settings.FillColor||DEFAULT_HIGHLIGHT_FILLCOLOR),line:Object.keys(h.Settings.Line).length?h.Settings.Line:{width:0}};shape={...shape,...h.Settings.Shape},layout.shapes.push(shape)}$(document).ready(function(){var bBox=chartBody.getBoundingClientRect();layout.height=bBox.width/1.5,Plotly.newPlot(chartBody,data,layout,config)});const resizeChartWidth=function(){var bBox=chartBody.getBoundingClientRect();Plotly.relayout(chartBody,{width:bBox.width,height:bBox.height})};return window.matchMedia&&window.matchMedia("print").addListener(function(print){print.matches?resizeChartWidth():Plotly.relayout(chartBody,{width:null,height:null,autosize:!0})}),window.onbeforeprint=resizeChartWidth,chartBody}function createSeries(title,dates,values,settings,markerOnly){const hasMarkers=!!settings.Markers,seriesObj={hoverinfo:"x+y+name+text"};return seriesObj.x=dates instanceof Array?dates:[dates],seriesObj.y=values instanceof Array?values:[values],seriesObj.mode="lines",seriesObj.name=title||"",seriesObj.type=(settings.Type||"scatter").toLowerCase(),seriesObj.stackgroup=settings.StackGroup||"",seriesObj.fill=settings.Fill||"none",seriesObj.fillcolor=$ru.printRgba(settings.FillColor)||"transparent",seriesObj.showlegend=!settings.hasOwnProperty("ShowLegend")||settings.ShowLegend,seriesObj.text=settings.Text||null,hasMarkers&&(seriesObj.mode+="+markers"),"bar"===seriesObj.type?seriesObj.marker={color:$ru.printRgba(settings.Color),line:{color:$ru.printRgba(settings.Color),width:1}}:(seriesObj.line={color:$ru.printRgba(settings.Color),width:settings.LineWidth},hasMarkers&&(seriesObj.marker=settings.Markers,seriesObj.marker.color=$ru.printRgba(seriesObj.marker.color||settings.Color))),seriesObj}function createMatrix(parent,matrixObj){const nDecParsed=parseInt(matrixObj.Settings.NumDecimals),nDecimals=isNaN(nDecParsed)?-1:nDecParsed;var matrixParent=document.createElement("div");if($(matrixParent).attr("id",matrixObj.Id),$(matrixParent).addClass("rephrase-matrix"),matrixObj.Settings.Class&&("string"==typeof matrixObj.Settings.Class||matrixObj.Settings.Class instanceof Array)&&$(matrixParent).addClass(matrixObj.Settings.Class),parent.appendChild(matrixParent),matrixObj.Title){var matrixTitle=document.createElement("div");$(matrixTitle).addClass(["rephrase-matrix-title","h3"]),matrixTitle.innerText=matrixObj.Title,matrixParent.appendChild(matrixTitle)}var matrixBodyDiv=document.createElement("div");if($(matrixBodyDiv).addClass(["rephrase-matrix-body","table-scroll"]),matrixParent.appendChild(matrixBodyDiv),matrixObj.Content&&matrixObj.Content instanceof Array&&matrixObj.Content.length>0){var matrix=document.createElement("table");$(matrix).addClass(["rephrase-matrix-table","hover","unstriped"]),matrixObj.Settings.Class&&("string"==typeof matrixObj.Settings.Class||matrixObj.Settings.Class instanceof Array)&&$(matrix).addClass(matrixObj.Settings.Class),matrixBodyDiv.appendChild(matrix);const hasColNames=matrixObj.Settings.ColNames&&matrixObj.Settings.ColNames instanceof Array&&matrixObj.Settings.ColNames.length>0,hasRowNames=matrixObj.Settings.RowNames&&matrixObj.Settings.RowNames instanceof Array&&matrixObj.Settings.RowNames.length>0;if(hasColNames){var thead=document.createElement("thead");$(thead).addClass("rephrase-matrix-header"),matrix.appendChild(thead);var theadRow=document.createElement("tr");if(thead.appendChild(theadRow),hasRowNames){var theadFirstCell=document.createElement("th");$(theadFirstCell).addClass(["rephrase-matrix-header-cell","rephrase-matrix-header-cell-col","rephrase-matrix-header-cell-row"]),theadRow.appendChild(theadFirstCell)}for(let i=0;i<matrixObj.Settings.ColNames.length;i++){const cName=matrixObj.Settings.ColNames[i];var theadCell=document.createElement("th");$(theadCell).addClass(["rephrase-matrix-header-cell","rephrase-matrix-header-cell-col"]),theadCell.innerText=cName,theadRow.appendChild(theadCell)}}var tbody=document.createElement("tbody");$(tbody).addClass("rephrase-matrix-table-body"),matrix.appendChild(tbody);const cellClasses=matrixObj.Settings.CellClasses;for(var i=0;i<matrixObj.Content.length;i++){var tbodyRow=document.createElement("tr");tbody.appendChild(tbodyRow);const matrixRow=matrixObj.Content[i],cellClassesRow=cellClasses instanceof Array?cellClasses[i]:null;if(hasRowNames){const rName=matrixObj.Settings.RowNames[i];theadCell=document.createElement("th");$(theadCell).addClass(["rephrase-matrix-header-cell","rephrase-matrix-header-cell-row"]),theadCell.innerText=rName,tbodyRow.appendChild(theadCell)}for(let j=0;j<matrixRow.length;j++){const v=-1===nDecimals?matrixRow[j]:matrixRow[j].toFixed(nDecimals),c=cellClassesRow instanceof Array?cellClassesRow[j]:null;var tbodyDataCell=document.createElement("td");$(tbodyDataCell).addClass("rephrase-matrix-data-cell"),c&&$(tbodyDataCell).addClass(c),tbodyDataCell.innerText=v,tbodyRow.appendChild(tbodyDataCell)}}}}function createTextBlock(parent,textObj){var textParent=document.createElement("div");if($(textParent).attr("id",textObj.Id),$(textParent).addClass("rephrase-text-block"),textObj.Settings.Class&&("string"==typeof textObj.Settings.Class||textObj.Settings.Class instanceof Array)&&$(textParent).addClass(textObj.Settings.Class),parent.appendChild(textParent),textObj.Title){var textTitle=document.createElement("h2");$(textTitle).addClass("rephrase-text-block-title"),textTitle.innerText=textObj.Title,textParent.appendChild(textTitle)}if(textObj.Content&&"string"==typeof textObj.Content){var textContent=document.createElement("div");if($(textContent).addClass("rephrase-text-block-body"),textObj.Settings.HighlightCodeBlocks){const renderer=new marked.Renderer;renderer.code=function(code,lang){const isIris="iris"===lang.toLowerCase();isIris&&(lang="matlab");const validLang=hljs.getLanguage(lang)?lang:"plaintext",theCode='<pre><code class="hljs'+(validLang?" language-"+validLang:"")+'">'+hljs.highlight(validLang,code).value+"</code></pre>";return isIris?postProcessIrisCode(postProcessMatlabCode(theCode)):postProcessMatlabCode(theCode)},marked.setOptions({renderer:renderer})}textContent.innerHTML=marked.parse(textObj.Content),textParent.appendChild(textContent),textObj.Settings.ParseFormulas&&window.renderMathInElement(textContent,{})}}function postProcessMatlabCode(code){return code=code.replace(/(\<span class\=['"]hljs\-comment)(['"]\>\s*%%\s+.*?\<\/span\>)/gim,"$1 hljs-bold$2")}function postProcessIrisCode(code){return code=(code=code.replace(/(![a-zA-Z_]*)/gim,"<span class='hljs-keyword'>$1</span>")).replace(/\{\<span class\=['"]hljs\-number['"]\>([\+\-]?\d+)\<\/span\>\}/gim,"<span class='hljs-symbol'>{$1}</span>")}function momentJsDateFormatToD3TimeFormat(dateFormat){for(var d3TimeFormat=dateFormat.replace("%","%%"),escaped=[],re=/\[(.*?)\]/gi,match=re.exec(d3TimeFormat);null!==match;)escaped.push(match[1]),match=re.exec(d3TimeFormat);var i=0;return d3TimeFormat=(d3TimeFormat=(d3TimeFormat=(d3TimeFormat=(d3TimeFormat=(d3TimeFormat=(d3TimeFormat=(d3TimeFormat=(d3TimeFormat=(d3TimeFormat=(d3TimeFormat=(d3TimeFormat=(d3TimeFormat=(d3TimeFormat=(d3TimeFormat=(d3TimeFormat=(d3TimeFormat=d3TimeFormat.replace(re,"[]")).replace("YYYY","%Y")).replace("YY","%y")).replace(/(^|[^%])Y/g,"$1%-Y")).replace("QQ","0%q")).replace("Q","%q")).replace("MMMM","%B")).replace("MMM","%b")).replace("MM","%m")).replace("M","%-m")).replace("dddd","%A")).replace("ddd","%a")).replace("DDDD","%j")).replace("DDD","%j")).replace("DD","%d")).replace("D","%-d")).replace(/\[\]/g,function(){return escaped[i++]})}function getColorList(){return $colorScheme.ColorOrder||DEFAULT_COLOR_SCHEME.ColorOrder}function printRgba(colorArray){return"transparent"===colorArray||"half-transparent"===colorArray?colorArray:colorArray&&4===colorArray.length?"rgba("+colorArray+")":void 0}function whitenRgba(colorArray,whitening,alpha){return colorArray&&4===colorArray.length&&"number"==typeof whitening?(alpha=alpha||colorArray[3],[...colorArray.slice(0,3).map(x=>x*(1-whitening)+255*whitening),alpha]):colorArray}function createTable(parent,tableObj){const TABLE_DATA_ROW_TYPES=["series","diffseries"];var tableParent=document.createElement("div");if($(tableParent).attr("id",tableObj.Id),$(tableParent).addClass(["rephrase-table-parent","table-scroll"]),parent.appendChild(tableParent),tableObj.Title){var tableTitle=document.createElement("h3");$(tableTitle).addClass("rephrase-table-title"),tableTitle.innerText=tableObj.Title}if(tableParent.appendChild(tableTitle),tableObj.Settings.DisplayRows=tableObj.Settings.DisplayRows||{Diff:!0,Baseline:!1,Alternative:!1},-1!==tableObj.Content.findIndex(function(el){return"diffseries"===el.Type.toLowerCase()})){var buttonGroup=document.createElement("div");$(buttonGroup).addClass(["small","button-group","rephrase-diff-table-button-group"]);var showBaselineBtn=document.createElement("a");showBaselineBtn.innerText="Hide Baseline",$(showBaselineBtn).addClass(["button","rephrase-diff-table-button","rephrase-diff-table-button-show-baseline"]),tableObj.Settings.DisplayRows.Baseline||(showBaselineBtn.innerText="Show Baseline",$(showBaselineBtn).addClass("hollow")),showBaselineBtn.addEventListener("click",onBtnClick,!1),buttonGroup.appendChild(showBaselineBtn);var showAlternativeBtn=document.createElement("a");showAlternativeBtn.innerText="Hide Alternative",$(showAlternativeBtn).addClass(["button","rephrase-diff-table-button","rephrase-diff-table-button-show-alternative"]),tableObj.Settings.DisplayRows.Alternative||(showAlternativeBtn.innerText="Show Alternative",$(showAlternativeBtn).addClass("hollow")),showAlternativeBtn.addEventListener("click",onBtnClick,!1),buttonGroup.appendChild(showAlternativeBtn);var showDiffBtn=document.createElement("a");showDiffBtn.innerText="Hide Diff",$(showDiffBtn).addClass(["button","rephrase-diff-table-button","rephrase-diff-table-button-show-diff"]),tableObj.Settings.DisplayRows.Diff||(showDiffBtn.innerText="Show Diff",$(showDiffBtn).addClass("hollow")),showDiffBtn.addEventListener("click",onBtnClick,!1),buttonGroup.appendChild(showDiffBtn),tableParent.appendChild(buttonGroup)}var table=document.createElement("table");$(table).addClass(["rephrase-table","hover","unstriped"]),tableObj.Settings.Class&&("string"==typeof tableObj.Settings.Class||tableObj.Settings.Class instanceof Array)&&$(table).addClass(tableObj.Settings.Class),tableParent.appendChild(table);var thead=document.createElement("thead");$(thead).addClass("rephrase-table-header"),table.appendChild(thead);var theadRow=document.createElement("tr");$(theadRow).addClass("rephrase-table-header-row"),thead.appendChild(theadRow);var tbody=document.createElement("tbody");$(tbody).addClass("rephrase-table-body"),table.appendChild(tbody);var theadFirstCell=document.createElement("th");$(theadFirstCell).addClass("rephrase-table-header-cell rephrase-table-first-cell"),theadFirstCell.innerText=tableObj.Settings.FirstCell,theadRow.appendChild(theadFirstCell);const showUnits=tableObj.Settings.ShowUnits;if(showUnits){theadFirstCell=document.createElement("th");$(theadFirstCell).addClass("rephrase-table-header-cell rephrase-table-units-column"),theadFirstCell.innerText=tableObj.Settings.UnitsHeading,theadRow.appendChild(theadFirstCell)}const dateFormat=tableObj.Settings.DateFormat,dates=tableObj.Settings.Dates.map(function(d){const t=moment(new Date(d)).format(dateFormat);var theadDateCell=document.createElement("th");return $(theadDateCell).addClass("rephrase-table-header-cell"),theadDateCell.innerText=t,theadRow.appendChild(theadDateCell),t});for(var i=0;i<tableObj.Content.length;i++){const tableRowObj=tableObj.Content[i];if(!(tableRowObj.hasOwnProperty("Type")&&["diffseries","series","heading"].includes(tableRowObj.Type.toLowerCase())&&("series"!==tableRowObj.Type.toLowerCase()||tableRowObj.hasOwnProperty("Content")&&("string"==typeof tableRowObj.Content||"object"==typeof tableRowObj.Content&&tableRowObj.Content.hasOwnProperty("Dates")&&tableRowObj.Content.hasOwnProperty("Values")&&dates instanceof Array&&tableRowObj.Content.Values.length===dates.length))&&("diffseries"!==tableRowObj.Type.toLowerCase()||tableRowObj.hasOwnProperty("Content")&&tableRowObj.Content instanceof Array&&("string"==typeof tableRowObj.Content[0]||"object"==typeof tableRowObj.Content[0]&&tableRowObj.Content[0].hasOwnProperty("Dates")&&tableRowObj.Content[0].hasOwnProperty("Values")&&dates instanceof Array&&tableRowObj.Content[0].Values.length===dates.length))))continue;const isDataRow=TABLE_DATA_ROW_TYPES.includes(tableRowObj.Type.toLowerCase());var tbodyRow=document.createElement("tr");if($ru.addUserClass(tbodyRow,tableRowObj),tbody.appendChild(tbodyRow),$(tbodyRow).addClass(["rephrase-table-row",isDataRow?"rephrase-table-data-row":"rephrase-table-heading-row"]),isDataRow)tableRowObj.Settings=appendObjSettings(tableRowObj.Settings||{},tableObj.Settings||{}),$ru.createTableSeries(tbodyRow,tableRowObj,showUnits);else{var tbodyTitleCell=document.createElement("td");tbodyTitleCell.setAttribute("colspan",dates.length+1),tbodyTitleCell.innerText=tableRowObj.Title||"",tbodyRow.appendChild(tbodyTitleCell)}}function onBtnClick(event){const thisBtn=event.target,tableParent=$(thisBtn).parent().parent(),otherBtn1=$(thisBtn).siblings()[0],otherBtn2=$(thisBtn).siblings()[1],isDiff=$(thisBtn).hasClass("rephrase-diff-table-button-show-diff"),isBaseline=$(thisBtn).hasClass("rephrase-diff-table-button-show-baseline"),btnType=isDiff?"diff":isBaseline?"baseline":"alternative";$(thisBtn).hasClass("hollow")?($(thisBtn).removeClass("hollow"),thisBtn.innerText=thisBtn.innerText.replace("Show","Hide"),toggleRows(tableParent,"show",btnType)):$(otherBtn1).hasClass("hollow")&&$(otherBtn2).hasClass("hollow")||($(thisBtn).addClass("hollow"),thisBtn.innerText=thisBtn.innerText.replace("Hide","Show"),toggleRows(tableParent,"hide",btnType))}function toggleRows(tableParent,toggleState,btnType){const rows="diff"===btnType?$(tableParent).find(".rephrase-diff-table-data-row-diff"):"baseline"===btnType?$(tableParent).find(".rephrase-diff-table-data-row-baseline"):$(tableParent).find(".rephrase-diff-table-data-row-alternative");for(var i=0;i<rows.length;i++){rows[i].style.display="hide"===toggleState?"none":""}}tableObj.Settings.DisplayRows.Diff||toggleRows(tableParent,"hide","diff"),tableObj.Settings.DisplayRows.Baseline||toggleRows(tableParent,"hide","baseline"),tableObj.Settings.DisplayRows.Alternative||toggleRows(tableParent,"hide","alternative")}function createTableSeries(tbodyRow,tableRowObj,showUnits){const nDecParsed=parseInt(tableRowObj.Settings.NumDecimals),nDecimals=isNaN(nDecParsed)?DEFAULT_NUM_DECIMALS:nDecParsed,diffMethod=(tableRowObj.Settings.Method||"Difference").toLowerCase(),nanValue=void 0===tableRowObj.Settings.NaN||null===tableRowObj.Settings.NaN?NaN:tableRowObj.Settings.NaN;var tbodyTitleCell=document.createElement("td");if($(tbodyTitleCell).addClass("rephrase-table-data-row-title"),tbodyTitleCell.innerText=tableRowObj.Title||"",tbodyRow.appendChild(tbodyTitleCell),showUnits){tbodyTitleCell=document.createElement("td");$(tbodyTitleCell).addClass("rephrase-table-data-row-title rephrase-table-units-column"),tbodyTitleCell.innerText=tableRowObj.Settings.Units||"",tbodyRow.appendChild(tbodyTitleCell)}if("diffseries"===tableRowObj.Type.toLowerCase()){$(tbodyRow).addClass("rephrase-diff-table-data-row-title"),tbodyTitleCell.setAttribute("colspan",tableRowObj.Settings.Dates.length+1);let diffRow=$ru.table.createDifftableSeriesRow("Diff",tableRowObj.Settings,showUnits),baselineRow=$ru.table.createDifftableSeriesRow("Baseline",tableRowObj.Settings,showUnits),alternativeRow=$ru.table.createDifftableSeriesRow("Alternative",tableRowObj.Settings,showUnits);var baselineSeries="string"==typeof tableRowObj.Content[0]?$ru.databank.getSeriesContent(tableRowObj.Content[0]):tableRowObj.Content[0],alternativeSeries="string"==typeof tableRowObj.Content[1]?$ru.databank.getSeriesContent(tableRowObj.Content[1]):tableRowObj.Content[1];let diffFunc=DIFF_METHOD[diffMethod]||DIFF_METHOD.diff,diffSuffix=DIFF_SUFFIX[diffMethod]||DIFF_SUFFIX.diff;for(var j=0;j<Math.max(baselineSeries.Values.length,alternativeSeries.Values.length);j++){const v1=null===baselineSeries.Values[j]?NaN:baselineSeries.Values[j],v2=null===alternativeSeries.Values[j]?NaN:alternativeSeries.Values[j],vDiff=diffFunc(v2,v1);var baselineDataCell=document.createElement("td");$(baselineDataCell).addClass(["rephrase-table-data-cell","rephrase-diff-table-data-cell-baseline",$ru.table.getTableNumberClass(v1)]),$(baselineDataCell).addClass($ru.table.evalConditionals(v1,tableRowObj.Settings.Conditional.Baseline)),baselineDataCell.innerText=$ru.table.printTableNumber(v1,nDecimals,nanValue),baselineRow.appendChild(baselineDataCell);var alternativeDataCell=document.createElement("td");$(alternativeDataCell).addClass(["rephrase-table-data-cell","rephrase-diff-table-data-cell-alternative",$ru.table.getTableNumberClass(v2)]),$(alternativeDataCell).addClass($ru.table.evalConditionals(v2,tableRowObj.Settings.Conditional.Alternative)),alternativeDataCell.innerText=$ru.table.printTableNumber(v2,nDecimals,nanValue),alternativeRow.appendChild(alternativeDataCell);var diffDataCell=document.createElement("td");$(diffDataCell).addClass(["rephrase-table-data-cell","rephrase-diff-table-data-cell-diff",$ru.table.getTableNumberClass(vDiff)]),$(diffDataCell).addClass($ru.table.evalConditionals(vDiff,tableRowObj.Settings.Conditional.Diff)),diffDataCell.innerText=$ru.table.printTableNumber(vDiff,nDecimals,nanValue)+diffSuffix,diffRow.appendChild(diffDataCell)}$(tbodyRow).after(baselineRow),$(baselineRow).after(alternativeRow),$(alternativeRow).after(diffRow)}else{"string"==typeof tableRowObj.Content&&(tableRowObj.Content=$ru.databank.getSeriesContent(tableRowObj.Content));for(let j=0;j<tableRowObj.Content.Values.length;j++){const v=null===tableRowObj.Content.Values[j]?NaN:tableRowObj.Content.Values[j];let tbodyDataCell=document.createElement("td");$(tbodyDataCell).addClass(["rephrase-table-data-cell",$ru.table.getTableNumberClass(v)]),tbodyDataCell.innerText=$ru.table.printTableNumber(v,nDecimals,nanValue),$(tbodyDataCell).addClass($ru.table.evalConditionals(v,tableRowObj.Settings.Conditional)),tbodyRow.appendChild(tbodyDataCell)}}}function printTableNumber(value,nDecimals,nanValue){return isNaN(value)?nanValue:value.toFixed(nDecimals)}function getTableNumberClass(value){return isNaN(value)?"rephrase-table-data-nan":0===value?"rephrase-table-data-zero":value<0?"rephrase-table-data-negative":value>0?"rephrase-table-data-positive":"rephrase-table-data-other"}function evalConditionals(value,conditionals){return conditionals?conditionals.filter(x=>(x.Bounds[0]||-1/0)<=value&&value<=(x.Bounds[1]||1/0)).map(x=>x.Class):""}function createDifftableSeriesRow(rowType,settings,showUnits){let row=document.createElement("tr");$(row).addClass(sprintf("rephrase-diff-table-data-row-%s",rowType.toLowerCase()));let rowTitleCell=document.createElement("td");return $(rowTitleCell).addClass(["rephrase-table-data-row-title",sprintf("rephrase-diff-table-data-row-%s-title",rowType.toLowerCase())]),rowTitleCell.setAttribute("colspan",1+showUnits),rowTitleCell.innerText=settings.RowTitles&&settings.RowTitles[rowType]?settings.RowTitles[rowType]:rowType,row.appendChild(rowTitleCell),row}function createGrid(parent,gridObj){var gridRowParent=document.createElement("div");$(gridRowParent).attr("id",gridObj.Id),$(gridRowParent).addClass(["rephrase-grid","grid-y","grid-padding-y"]),parent.appendChild(gridRowParent);const title=$ru.getTitle(gridObj);if(title){const gridTitleElement=document.createElement("h2");$(gridTitleElement).addClass("rephrase-grid-title"),gridTitleElement.innerText=title,gridRowParent.appendChild(gridTitleElement)}const nTiles=gridObj.Content.length,nCols=gridObj.Settings.NumColumns,nRows=Math.ceil(nTiles/nCols);for(var i=0;i<nRows;i++){var gridRow=document.createElement("div");$(gridRow).addClass(["cell","shrink"]),gridRowParent.appendChild(gridRow);var gridColParent=document.createElement("div");$(gridColParent).addClass(["grid-x","grid-padding-x"]),gridRow.appendChild(gridColParent);for(let j=0;j<nCols;j++){const contentIndex=nCols*i+j;var gridCol=document.createElement("div");$(gridCol).addClass(["cell","auto"]),gridColParent.appendChild(gridCol);const gridElementObj=gridObj.Content[contentIndex];$ru.addReportElement(gridCol,gridElementObj,gridObj.Settings)}}}function createPager(parent,pagerObj){var pagerParent=document.createElement("div");$(pagerParent).attr("id",pagerObj.Id),$(pagerParent).addClass(["rephrase-pager"]),parent.appendChild(pagerParent);const title=$ru.getTitle(pagerObj);if(title){const pagerTitleElement=document.createElement("h2");$(pagerTitleElement).addClass("rephrase-pager-title"),pagerTitleElement.innerText=title,pagerParent.appendChild(pagerTitleElement)}const nPages=pagerObj.Content.length,sliderArea=document.createElement("div");$(sliderArea).addClass(["rephrase-pager-slider-area","grid-x","grid-margin-x"]),$(pagerParent).append(sliderArea);const sliderParent=document.createElement("div");sliderParent.setAttribute("data-slider",""),$(sliderParent).addClass(["rephrase-pager-slider","slider"]),$(sliderParent).append("<span class='slider-handle' data-slider-handle role='slider' tabindex='1'></span>"),$(sliderParent).append("<span class='slider-fill' data-slider-fill></span>"),$(sliderParent).append("<input type='hidden'>"),1==nPages&&$(sliderParent).addClass("disabled"),$(sliderArea).append($("<div class='cell auto'></div>").append($(sliderParent)));var sliderButtons=$("<div class='cell small-2'></div>");const dropdownArea=$("<div class='rephrase-pager-dropdown-area'></div>"),dropdownSelect=$("<select></select>").on("change",function(){var newVal,input;newVal=this.value,+(input=$(sliderParent).find("input")).val()!==newVal&&(input.val(newVal).trigger("change"),updateButtons())});dropdownSelect.addClass("h3");for(let i=0;i<nPages;i++){const title=pagerObj.Content[i].Title||"Untitled page {i}";dropdownSelect.append($(`<option value='${i}'>${title}</option>`)),pagerObj.Content[i].Settings.ShowTitle=!1}dropdownArea.append(dropdownSelect),$(pagerParent).append(dropdownArea);var prevButton=$("<a class='button hollow rephrase-pager-slider-prev-button' accesskey=','>&lt;&lt;</a>").on("click",function(){updateSliderBy(-1)}),nextButton=$("<a class='button hollow rephrase-pager-slider-next-button' accesskey='.'>&gt;&gt;</a>").on("click",function(){updateSliderBy(1)});$(sliderParent).find("input")[0].value=0,sliderButtons.append(prevButton),sliderButtons.append(nextButton),$(sliderArea).append(sliderButtons),$(sliderParent).on("changed.zf.slider",function(){showPage($(sliderParent).find("input")[0].value)});const startPage=Math.min(nPages-1,pagerObj.Settings.StartPage||0);new Foundation.Slider($(sliderParent),{initialStart:startPage,end:nPages-1});function updateSliderBy(sign){const input=$(sliderParent).find("input"),oldVal=+input.val(),newVal=Math.min(nPages,Math.max(0,oldVal+sign));oldVal!==newVal&&(input.val(newVal).trigger("change"),updateButtons())}function updateButtons(){const val=$(sliderParent).find("input").val();0!=val?(prevButton.removeClass("disabled"),prevButton.removeAttr("aria-disabled")):(prevButton.addClass("disabled"),prevButton.attr("aria-disabled","")),val!=nPages-1?(nextButton.removeClass("disabled"),nextButton.removeAttr("aria-disabled")):(nextButton.addClass("disabled"),nextButton.attr("aria-disabled","")),dropdownSelect[0].value=val}function showPage(p){$(pagerParent).find(".rephrase-pager-page").hide();var thisPage=$(pagerParent).find("#page"+p+".rephrase-pager-page");if(thisPage.length)thisPage.show();else{var page=document.createElement("div");$(page).addClass(["rephrase-pager-page"]),$(page).attr("id","page"+p),pagerParent.appendChild(page),$ru.addReportElement(page,pagerObj.Content[p],pagerObj.Settings)}updateButtons()}showPage(startPage)}function createSection(parent,sectionObj){var sectionParent=document.createElement("div");$(sectionParent).attr("id",sectionObj.Id),$(sectionParent).addClass(["rephrase-section"]),parent.appendChild(sectionParent);const title=$ru.getTitle(sectionObj);if(title){var sectionTitleElement=document.createElement(sectionObj.Settings&&sectionObj.Settings.Tag?sectionObj.Settings.Tag:"h2");$(sectionTitleElement).addClass("rephrase-pager-title"),sectionTitleElement.innerText=title,sectionParent.appendChild(sectionTitleElement)}const sectionContent=sectionObj.Content instanceof Array?sectionObj.Content:[sectionObj.Content];for(let i=0;i<sectionContent.length;i++){const elementObj=sectionContent[i];$ru.addReportElement(sectionParent,elementObj,sectionObj.Settings)}}function createWrapper(parent,wrapperObj){for(let elementObj of wrapperObj.Content)$ru.addReportElement(parent,elementObj,wrapperObj.Settings)}function addReportElement(parentElement,elementObj,parentObjSettings){if(!elementObj||"object"!=typeof elementObj||!elementObj.hasOwnProperty("Type"))return{};switch(elementObj.Settings=appendObjSettings(elementObj.Settings||{},parentObjSettings||{}),elementObj.Type.toLowerCase()){case"chart":case"serieschart":case"linearchart":case"curvechart":$ru.createChart(parentElement,elementObj);break;case"table":$ru.createTable(parentElement,elementObj);break;case"matrix":$ru.createMatrix(parentElement,elementObj);break;case"grid":$ru.createGrid(parentElement,elementObj);break;case"pager":$ru.createPager(parentElement,elementObj);break;case"text":$ru.createTextBlock(parentElement,elementObj);break;case"section":$ru.createSection(parentElement,elementObj);break;case"wrapper":$ru.createWrapper(parentElement,elementObj);break;case"pagebreak":$ru.addPageBreak(parentElement,elementObj);break;default:console.log("Unknown report element")}}function getElementIds(content){var ids=[];const thisContent=content instanceof Array?content:[content];for(var i=0;i<thisContent.length;i++)thisContent[i]&&(thisContent[i].hasOwnProperty("Id")&&ids.push(thisContent[i].Id),thisContent[i].hasOwnProperty("Content")&&(thisContent[i].Content instanceof Array||"object"==typeof thisContent[i].Content)&&(ids=ids.concat(getElementIds(thisContent[i].Content))));return ids}function generateToc(parentList,content,depth,excludeTypes){const thisContent=content instanceof Array?content:[content];for(var i=0;i<thisContent.length;i++)if(thisContent[i]&&"object"==typeof thisContent[i]&&thisContent[i].hasOwnProperty("Id")&&thisContent[i].hasOwnProperty("Type")&&!excludeTypes.includes(thisContent[i].Type)){var tocMenuEntry=document.createElement("li");$(tocMenuEntry).addClass("report-toc-menu-entry");var tocMenuEntryLink=document.createElement("a");if($(tocMenuEntryLink).addClass("report-toc-menu-entry-link"),$(tocMenuEntryLink).attr("href","#"+thisContent[i].Id),$(tocMenuEntryLink).text(thisContent[i].Title||"Untitled element"),tocMenuEntry.appendChild(tocMenuEntryLink),depth>1&&"pager"!==thisContent[i].Type.toLowerCase()&&thisContent[i].hasOwnProperty("Content")&&"object"==typeof thisContent[i].Content){var tocSubMenu=document.createElement("ul");$(tocSubMenu).addClass(["nested","vertical","menu","report-toc-menu-content"]),tocSubMenu=$ru.generateToc(tocSubMenu,thisContent[i].Content,depth-1,excludeTypes),tocMenuEntry.appendChild(tocSubMenu)}parentList.appendChild(tocMenuEntry)}return parentList}function appendObjSettings(objSettings,parentSettings){const parentKeys=Object.keys(parentSettings);for(let i=0;i<parentKeys.length;i++){const key=parentKeys[i];"class"!==key.toLowerCase()&&(objSettings.hasOwnProperty(key)||(objSettings[key]=parentSettings[key]))}return objSettings}function getTitle(obj){return obj.Settings.hasOwnProperty("ShowTitle")&&!obj.Settings.ShowTitle?"":obj.Title}function addUserClass(element,reportObj){reportObj.Settings.Class&&("string"==typeof reportObj.Settings.Class||reportObj.Settings.Class instanceof Array)&&$(element).addClass(reportObj.Settings.Class)}var $defaultSettings={};$(document).foundation(),function(){const EXCLUDE_FROM_TOC=["SERIES","DIFFSERIES","HEADING","WRAPPER","PAGEBREAK"];if(document.title=$report.Title||"",$report.Settings.Class&&("string"==typeof $report.Settings.Class||$report.Settings.Class instanceof Array)){var reportDiv=document.querySelector(".report-content");$(reportDiv).addClass($report.Settings.Class)}var headerDiv=document.querySelector(".report-header");if($report.hasOwnProperty("Title")&&null!==$report.Title){var headerTextDiv=headerDiv.querySelector(".header-text");headerTextDiv.querySelector(".title").innerText=$report.Title||"",headerTextDiv.querySelector(".subtitle").innerText=$report.Settings.Subtitle||"";var leftLogoDiv=headerDiv.querySelector(".left-logo"),rightLogoDiv=headerDiv.querySelector(".right-logo");const hiddenLogoImg=document.querySelector(".report-default-logo");if(!$report.Settings.hasOwnProperty("Logo")){const imgSrc=hiddenLogoImg.getAttribute("src")||"";$report.Settings.Logo={Path:imgSrc,Position:"Left"}}hiddenLogoImg.parentNode.removeChild(hiddenLogoImg);var logo=$report.Settings.Logo||[];"object"!=typeof logo||logo instanceof Array||(logo=[logo]);for(var hasLeft,hasRight=!1,i=0;i<logo.length;i++){const lg=logo[i];"object"==typeof lg&&lg.hasOwnProperty("Path")&&lg.Path&&lg.hasOwnProperty("Position")&&"None"!==lg.Position&&("left"===lg.Position.toLowerCase()&&(leftLogoDiv.innerHTML='<img class="left-logo-img" src="'+lg.Path+'" alt="logo"></img>',hasLeft=!0),"right"===lg.Position.toLowerCase()&&(rightLogoDiv.innerHTML='<img class="right-logo-img" src="'+lg.Path+'" alt="logo"></img>',hasRight=!0))}hasLeft||(leftLogoDiv.style.display="none"),hasRight||(rightLogoDiv.style.display="none")}else;var footerDiv=document.querySelector(".report-footer");$report.Settings.hasOwnProperty("Footer")&&null!==$report.Settings.Footer?footerDiv.querySelector(".footer-text").innerText=$report.Settings.Footer||"":footerDiv.style.display="none";var tocWrapperDiv=document.querySelector(".report-toc-menu-wrapper"),tocButton=document.querySelector(".report-toc-button");if($report.Settings.hasOwnProperty("TableOfContents")&&$report.Settings.TableOfContents){var tocMenuDiv=document.querySelector(".report-toc-menu"),tocMenu=document.createElement("ul");$(tocMenu).addClass(["vertical","menu","report-toc-menu-content"]);const tocDepth=$report.Settings.hasOwnProperty("TableOfContentsDepth")?$report.Settings.TableOfContentsDepth:2,tocExcludeTypes=EXCLUDE_FROM_TOC;tocMenu=$ru.generateToc(tocMenu,$report.Content,tocDepth,tocExcludeTypes),tocMenuDiv.appendChild(tocMenu)}else tocWrapperDiv.style.display="none",tocButton.style.display="none";var bodyDiv=document.querySelector(".report-body");for(let i=0;i<$report.Content.length;i++){const elementObj=$report.Content[i];$ru.addReportElement(bodyDiv,elementObj,$report.Settings)}}();