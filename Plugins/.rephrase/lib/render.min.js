"use strict";var $ru={createChart:createChart,createChartSeries:createChartSeries,createChartForChartJs:createChartForChartJs,createSeriesForChartJs:createSeriesForChartJs,createChartForPlotly:createChartForPlotly,createSeriesForPlotly:createSeriesForPlotly,freqToUnit:freqToMomentJsUnit,createTable:createTable,createTableSeries:createTableSeries,createGrid:createGrid,createMatrix:createMatrix,addReportElement:addReportElement,getColorList:getColorList,addPageBreak:addPageBreak,createWrapper:createWrapper,createTextBlock:createTextBlock,appendObjSettings:appendObjSettings,momentJsDateFormatToD3TimeFormat:momentJsDateFormatToD3TimeFormat,postProcessIrisCode:postProcessIrisCode,databank:{getEntry:getEntry,getEntryName:getEntryName,getSeriesContent:getSeriesContent}};const DEFAULT_CHART_LIBRARY="plotly",DEFAULT_HIGHLIGHT_COLOR="rgba(100, 100, 100, 0.2)";function createChart(parent,chartObj){const chartLib=chartObj.Settings.ChartLibrary||DEFAULT_CHART_LIBRARY;var chartParent=document.createElement("div");$(chartParent).addClass("rephrase-chart"),chartObj.Settings.Class&&("string"==typeof chartObj.Settings.Class||chartObj.Settings.Class instanceof Array)&&$(chartParent).addClass(chartObj.Settings.Class),parent.appendChild(chartParent);const hideTitle=chartObj.Settings.hasOwnProperty("DisplayTitle")&&!chartObj.Settings.DisplayTitle,chartTitle=chartObj.Title||"";if(chartTitle&&!hideTitle){var chartTitleDiv=document.createElement("div");$(chartTitleDiv).addClass(["rephrase-chart-title","h4"]),chartTitleDiv.innerText=chartTitle,chartParent.appendChild(chartTitleDiv)}var data=[];const limits={min:chartObj.Settings.StartDate?new Date(chartObj.Settings.StartDate):null,max:chartObj.Settings.EndDate?new Date(chartObj.Settings.EndDate):null};if(chartObj.hasOwnProperty("Content")&&chartObj.Content instanceof Array){const colorList=$ru.getColorList(chartObj.Content.length);for(var i=0;i<chartObj.Content.length;i++){const seriesObj=chartObj.Content[i];seriesObj.Settings=appendObjSettings(seriesObj.Settings||{},chartObj.Settings||{}),data.push($ru.createChartSeries(seriesObj,limits,colorList[i],chartLib))}}const interactive=!chartObj.Settings.hasOwnProperty("InteractiveCharts")||chartObj.Settings.InteractiveCharts,chartBody="chartjs"===chartLib.toLowerCase()?$ru.createChartForChartJs(data,limits,chartObj.Settings.DateFormat,chartObj.Settings.Highlight||[]):$ru.createChartForPlotly(data,limits,chartObj.Settings.DateFormat,chartObj.Settings.Highlight||[],interactive);chartParent.appendChild(chartBody)}function createChartSeries(seriesObj,limits,color,chartLib){if(!(seriesObj&&"object"==typeof seriesObj&&seriesObj.hasOwnProperty("Type")&&"series"===seriesObj.Type.toLowerCase()&&seriesObj.hasOwnProperty("Content")&&("string"==typeof seriesObj.Content||"object"==typeof seriesObj.Content&&seriesObj.Content.hasOwnProperty("Dates")&&seriesObj.Content.hasOwnProperty("Values"))))return{};"string"==typeof seriesObj.Content?seriesObj.Content=$ru.databank.getSeriesContent(seriesObj.Content):seriesObj.Content.Dates=seriesObj.Content.Dates.map(function(d){return new Date(d)});const overrideColor=seriesObj.hasOwnProperty("Settings")&&"object"==typeof seriesObj.Settings&&seriesObj.Settings.hasOwnProperty("Color")?seriesObj.Settings.Color:null,colors={barFaceColor:(overrideColor||color).replace(/,\s*\d*\.?\d+\)$/,",0.2)"),barBorderColor:overrideColor||color,lineColor:overrideColor||color};switch(chartLib.toLowerCase()){case"chartjs":return $ru.createSeriesForChartJs(seriesObj.Title,seriesObj.Content.Dates,seriesObj.Content.Values,seriesObj.Settings.Type,colors,limits);case"plotly":default:return $ru.createSeriesForPlotly(seriesObj.Title,seriesObj.Content.Dates,seriesObj.Content.Values,seriesObj.Settings.Type,colors)}}function getEntry(name){return $databank&&"object"==typeof $databank&&$databank.hasOwnProperty(name)?$databank[name]:{}}function getEntryName(name){return getEntry(name).Name||""}function getSeriesContent(name){const dataObj=getEntry(name);if(dataObj&&"object"==typeof dataObj&&dataObj.hasOwnProperty("Values")&&dataObj.Values instanceof Array&&dataObj.hasOwnProperty("Dates")){var dates=[];if(dataObj.Dates instanceof Array)dates=dataObj.Dates.map(function(d){return new Date(d)});else{const freqUnit=$ru.freqToUnit(dataObj.Frequency),startDate=new Date(dataObj.Dates);for(var i=0;i<dataObj.Values.length;i++)dates.push(moment(startDate).add(i,freqUnit).toDate())}return{Values:dataObj.Values,Dates:dates}}return{}}function addPageBreak(parent,breakObj){var pageBreakDiv=document.createElement("div");$(pageBreakDiv).addClass("page-break"),pageBreakDiv.innerHTML="&nbsp;",parent.appendChild(pageBreakDiv)}function createChartForChartJs(data,limits,dateFormat,highlight){var canvas=document.createElement("canvas");$(canvas).addClass("rephrase-chart-body"),Chart.defaults.global.defaultFontFamily="Lato";const chartConfig={type:"line",data:{datasets:data},options:{title:{display:!1},tooltips:{intersect:!1,mode:"x",callbacks:{label:function(tooltipItem,data){var label=data.datasets[tooltipItem.datasetIndex].label||"";return label&&(label+=": "),label+=Math.round(1e3*tooltipItem.yLabel)/1e3}}},aspectRatio:1.5,maintainAspectRatio:!0,scales:{xAxes:[{id:"x-axis",type:"time",distribution:"series",ticks:{min:limits.min,max:limits.max,callback:function(d){return moment(new Date(d)).format(dateFormat)}},time:{minUnit:"day",tooltipFormat:dateFormat}}]}}};if(highlight&&highlight instanceof Array&&highlight.length>0){chartConfig.options.annotation={drawTime:"beforeDatasetsDraw",annotations:[]};for(let i=0;i<highlight.length;i++){const hConfig=highlight[i];chartConfig.options.annotation.annotations.push({id:"highlight-"+i,type:"box",xScaleID:"x-axis",xMin:hConfig.StartDate?new Date(hConfig.StartDate):void 0,xMax:hConfig.EndDate?new Date(hConfig.EndDate):void 0,backgroundColor:hConfig.Color||DEFAULT_HIGHLIGHT_COLOR,borderColor:hConfig.Color||DEFAULT_HIGHLIGHT_COLOR})}}return new Chart(canvas,chartConfig),canvas}function createSeriesForChartJs(title,dates,values,seriesType,colors,limits){for(var tsData=[],i=0;i<values.length;i++){const thisDate=dates[i];limits.min&&thisDate<limits.min||limits.max&&thisDate>limits.max||tsData.push({x:thisDate,y:values[i]})}var seriesObj={data:tsData,label:title||"",type:(seriesType||"line").toLowerCase()};return"bar"===seriesObj.type?(seriesObj.borderWidth=1,seriesObj.borderColor=colors.barBorderColor,seriesObj.backgroundColor=colors.barFaceColor):(seriesObj.lineTension=0,seriesObj.fill=!1,seriesObj.borderColor=colors.lineColor,seriesObj.backgroundColor=colors.lineColor),seriesObj}function createChartForPlotly(data,limits,dateFormat,highlight,interactive){var chartBody=document.createElement("div");$(chartBody).addClass("rephrase-chart-body");const layout={font:{family:"Lato",color:"#0a0a0a"},xaxis:{range:[limits.min,limits.max],type:"date",tickformat:$ru.momentJsDateFormatToD3TimeFormat(dateFormat)},yaxis:{autorange:!0,type:"linear",fixedrange:!0},legend:{x:.5,y:1,xanchor:"center",yanchor:"bottom",orientation:"h"},margin:{l:50,r:50,b:30,t:10,pad:4}},config={responsive:!0,staticPlot:!interactive};if(highlight&&highlight instanceof Array&&highlight.length>0){layout.shapes=[];for(let i=0;i<highlight.length;i++){const hConfig=highlight[i];layout.shapes.push({type:"rect",xref:"x",yref:"paper",x0:hConfig.StartDate?new Date(hConfig.StartDate):limits.min,y0:0,x1:hConfig.EndDate?new Date(hConfig.EndDate):limits.max,y1:1,fillcolor:hConfig.Color||DEFAULT_HIGHLIGHT_COLOR,line:{width:0}})}}$(document).ready(function(){Plotly.newPlot(chartBody,data,layout,config)});const resizeChartWidth=function(){var bBox=chartBody.getBoundingClientRect();Plotly.relayout(chartBody,{width:bBox.width,height:bBox.height})};return window.matchMedia&&window.matchMedia("print").addListener(function(print){print.matches?resizeChartWidth():Plotly.relayout(chartBody,{width:null,height:null,autosize:!0})}),window.onbeforeprint=resizeChartWidth,chartBody}function createSeriesForPlotly(title,dates,values,seriesType,colors){var seriesObj={x:dates,y:values,name:title||"",type:(seriesType||"scatter").toLowerCase()};return"bar"===seriesObj.type?seriesObj.marker={color:colors.barFaceColor,line:{color:colors.barBorderColor,width:1}}:seriesObj.marker={line:{color:colors.lineColor}},seriesObj}function createMatrix(parent,matrixObj){const nDecimals=matrixObj.Settings.NumDecimals||-1;var matrixParent=document.createElement("div");if($(matrixParent).addClass("rephrase-matrix"),matrixObj.Settings.Class&&("string"==typeof matrixObj.Settings.Class||matrixObj.Settings.Class instanceof Array)&&$(matrixParent).addClass(matrixObj.Settings.Class),parent.appendChild(matrixParent),matrixObj.Title){var matrixTitle=document.createElement("div");$(matrixTitle).addClass(["rephrase-matrix-title","h3"]),matrixTitle.innerText=matrixObj.Title,matrixParent.appendChild(matrixTitle)}var matrixBodyDiv=document.createElement("div");if($(matrixBodyDiv).addClass(["rephrase-matrix-body","table-scroll"]),matrixParent.appendChild(matrixBodyDiv),matrixObj.Content&&matrixObj.Content instanceof Array&&matrixObj.Content.length>0){var matrix=document.createElement("table");$(matrix).addClass(["rephrase-matrix-table","hover","unstriped"]),matrixObj.Settings.Class&&("string"==typeof matrixObj.Settings.Class||matrixObj.Settings.Class instanceof Array)&&$(matrix).addClass(matrixObj.Settings.Class),matrixBodyDiv.appendChild(matrix);const hasColNames=matrixObj.Settings.ColNames&&matrixObj.Settings.ColNames instanceof Array&&matrixObj.Settings.ColNames.length>0,hasRowNames=matrixObj.Settings.RowNames&&matrixObj.Settings.RowNames instanceof Array&&matrixObj.Settings.RowNames.length>0;if(hasColNames){var thead=document.createElement("thead");$(thead).addClass("rephrase-matrix-header"),matrix.appendChild(thead);var theadRow=document.createElement("tr");if(thead.appendChild(theadRow),hasRowNames){var theadFirstCell=document.createElement("th");$(theadFirstCell).addClass(["rephrase-matrix-header-cell","rephrase-matrix-header-cell-col","rephrase-matrix-header-cell-row"]),theadRow.appendChild(theadFirstCell)}for(let i=0;i<matrixObj.Settings.ColNames.length;i++){const cName=matrixObj.Settings.ColNames[i];var theadCell=document.createElement("th");$(theadCell).addClass(["rephrase-matrix-header-cell","rephrase-matrix-header-cell-col"]),theadCell.innerText=cName,theadRow.appendChild(theadCell)}}var tbody=document.createElement("tbody");$(tbody).addClass("rephrase-matrix-table-body"),matrix.appendChild(tbody);for(var i=0;i<matrixObj.Content.length;i++){var tbodyRow=document.createElement("tr");tbody.appendChild(tbodyRow);const matrixRow=matrixObj.Content[i];if(hasRowNames){const rName=matrixObj.Settings.RowNames[i];theadCell=document.createElement("th");$(theadCell).addClass(["rephrase-matrix-header-cell","rephrase-matrix-header-cell-row"]),theadCell.innerText=rName,tbodyRow.appendChild(theadCell)}for(let j=0;j<matrixRow.length;j++){const v=-1===nDecimals?matrixRow[j]:matrixRow[j].toFixed(nDecimals);var tbodyDataCell=document.createElement("td");$(tbodyDataCell).addClass("rephrase-matrix-data-cell"),tbodyDataCell.innerText=v,tbodyRow.appendChild(tbodyDataCell)}}}}function createTextBlock(parent,textObj){var textParent=document.createElement("div");if($(textParent).addClass("rephrase-text-block"),textObj.Settings.Class&&("string"==typeof textObj.Settings.Class||textObj.Settings.Class instanceof Array)&&$(textParent).addClass(textObj.Settings.Class),parent.appendChild(textParent),textObj.Title){var textTitle=document.createElement("h2");$(textTitle).addClass("rephrase-text-block-title"),textTitle.innerText=textObj.Title,textParent.appendChild(textTitle)}if(textObj.Content&&"string"==typeof textObj.Content){var textContent=document.createElement("div");if($(textContent).addClass("rephrase-text-block-body"),textObj.Settings.HighlightCodeBlocks){const renderer=new marked.Renderer;renderer.code=function(code,lang){const isIris="iris"===lang.toLowerCase();isIris&&(lang="matlab");const validLang=hljs.getLanguage(lang)?lang:"plaintext",theCode='<pre><code class="hljs'+(validLang?" language-"+validLang:"")+'">'+hljs.highlight(validLang,code).value+"</code></pre>";return isIris?postProcessIrisCode(postProcessMatlabCode(theCode)):postProcessMatlabCode(theCode)},marked.setOptions({renderer:renderer})}textContent.innerHTML=marked(textObj.Content),textParent.appendChild(textContent),textObj.Settings.ParseFormulas&&window.renderMathInElement(textContent,{})}}function postProcessMatlabCode(code){return code=code.replace(/(\<span class\=['"]hljs\-comment)(['"]\>\s*%%\s+.*?\<\/span\>)/gim,"$1 hljs-bold$2")}function postProcessIrisCode(code){return code=(code=code.replace(/(![a-zA-Z_]*)/gim,"<span class='hljs-keyword'>$1</span>")).replace(/\{\<span class\=['"]hljs\-number['"]\>([\+\-]?\d+)\<\/span\>\}/gim,"<span class='hljs-symbol'>{$1}</span>")}function momentJsDateFormatToD3TimeFormat(dateFormat){for(var d3TimeFormat=dateFormat.replace("%","%%"),escaped=[],re=/\[(.*?)\]/gi,match=re.exec(d3TimeFormat);null!==match;)escaped.push(match[1]),match=re.exec(d3TimeFormat);var i=0;return d3TimeFormat=(d3TimeFormat=(d3TimeFormat=(d3TimeFormat=(d3TimeFormat=(d3TimeFormat=(d3TimeFormat=(d3TimeFormat=(d3TimeFormat=(d3TimeFormat=(d3TimeFormat=(d3TimeFormat=(d3TimeFormat=(d3TimeFormat=(d3TimeFormat=(d3TimeFormat=d3TimeFormat.replace(re,"[]")).replace("YYYY","%Y")).replace("YY","%y")).replace("QQ","0%q")).replace("Q","%q")).replace("MMMM","%B")).replace("MMM","%b")).replace("MM","%m")).replace("M","%-m")).replace("dddd","%A")).replace("ddd","%a")).replace("DDDD","%j")).replace("DDD","%j")).replace("DD","%d")).replace("D","%-d")).replace(/\[\]/g,function(){return escaped[i++]})}function freqToMomentJsUnit(freq){var unit="";switch(freq){case 365:unit="day";break;case 52:unit="week";break;case 12:unit="month";break;case 4:unit="quarter";break;case 1:unit="year";break;default:unit=""}return unit}function getColorList(nColors){const defaultColorList=["rgba(0, 114, 189, 1)","rgba(217, 83, 25, 1)","rgba(237, 177, 32, 1)","rgba(126, 47, 142, 1)","rgba(119, 172, 48, 1)","rgba(77, 190, 238, 1)","rgba(162, 20, 47, 1)"],nDefaults=defaultColorList.length;for(var colorList=[],i=0;i<nColors;i++)colorList.push(defaultColorList[i%nDefaults]);return colorList}function createTable(parent,tableObj){var tableParent=document.createElement("div");if($(tableParent).addClass(["rephrase-table-parent","table-scroll"]),parent.appendChild(tableParent),tableObj.Title){var tableTitle=document.createElement("h3");$(tableTitle).addClass("rephrase-table-title"),tableTitle.innerText=tableObj.Title}if(tableParent.appendChild(tableTitle),tableObj.Settings.DisplayRows=tableObj.Settings.DisplayRows||{Diff:!0,Baseline:!1,Alternative:!1},-1!==tableObj.Content.findIndex(function(el){return"diffseries"===el.Type.toLowerCase()})){var buttonGroup=document.createElement("div");$(buttonGroup).addClass(["small","button-group","rephrase-diff-table-button-group"]);var showBaselineBtn=document.createElement("a");showBaselineBtn.innerText="Hide Baseline",$(showBaselineBtn).addClass(["button","rephrase-diff-table-button","rephrase-diff-table-button-show-baseline"]),tableObj.Settings.DisplayRows.Baseline||(showBaselineBtn.innerText="Show Baseline",$(showBaselineBtn).addClass("hollow")),showBaselineBtn.addEventListener("click",onBtnClick,!1),buttonGroup.appendChild(showBaselineBtn);var showAlternativeBtn=document.createElement("a");showAlternativeBtn.innerText="Hide Alternative",$(showAlternativeBtn).addClass(["button","rephrase-diff-table-button","rephrase-diff-table-button-show-alternative"]),tableObj.Settings.DisplayRows.Alternative||(showAlternativeBtn.innerText="Show Alternative",$(showAlternativeBtn).addClass("hollow")),showAlternativeBtn.addEventListener("click",onBtnClick,!1),buttonGroup.appendChild(showAlternativeBtn);var showDiffBtn=document.createElement("a");showDiffBtn.innerText="Hide Diff",$(showDiffBtn).addClass(["button","rephrase-diff-table-button","rephrase-diff-table-button-show-diff"]),tableObj.Settings.DisplayRows.Diff||(showDiffBtn.innerText="Show Diff",$(showDiffBtn).addClass("hollow")),showDiffBtn.addEventListener("click",onBtnClick,!1),buttonGroup.appendChild(showDiffBtn),tableParent.appendChild(buttonGroup)}var table=document.createElement("table");$(table).addClass(["rephrase-table","hover","unstriped"]),tableObj.Settings.Class&&("string"==typeof tableObj.Settings.Class||tableObj.Settings.Class instanceof Array)&&$(table).addClass(tableObj.Settings.Class),tableParent.appendChild(table);var thead=document.createElement("thead");$(thead).addClass("rephrase-table-header"),table.appendChild(thead);var theadRow=document.createElement("tr");$(theadRow).addClass("rephrase-table-header-row"),thead.appendChild(theadRow);var tbody=document.createElement("tbody");$(tbody).addClass("rephrase-table-body"),table.appendChild(tbody);var theadFirstCell=document.createElement("th");$(theadFirstCell).addClass("rephrase-table-header-cell"),theadRow.appendChild(theadFirstCell);const dates=tableObj.Settings.Dates.map(function(d){const t=moment(new Date(d)).format(tableObj.Settings.DateFormat);var theadDateCell=document.createElement("th");return $(theadDateCell).addClass("rephrase-table-header-cell"),theadDateCell.innerText=t,theadRow.appendChild(theadDateCell),t});for(var i=0;i<tableObj.Content.length;i++){const tableRowObj=tableObj.Content[i];if(!(tableRowObj.hasOwnProperty("Type")&&-1!==["diffseries","series","heading"].indexOf(tableRowObj.Type.toLowerCase())&&("series"!==tableRowObj.Type.toLowerCase()||tableRowObj.hasOwnProperty("Content")&&("string"==typeof tableRowObj.Content||"object"==typeof tableRowObj.Content&&tableRowObj.Content.hasOwnProperty("Dates")&&tableRowObj.Content.hasOwnProperty("Values")&&dates instanceof Array&&tableRowObj.Content.Values.length===dates.length))&&("diffseries"!==tableRowObj.Type.toLowerCase()||tableRowObj.hasOwnProperty("Content")&&tableRowObj.Content instanceof Array&&("string"==typeof tableRowObj.Content[0]||"object"==typeof tableRowObj.Content[0]&&tableRowObj.Content[0].hasOwnProperty("Dates")&&tableRowObj.Content[0].hasOwnProperty("Values")&&dates instanceof Array&&tableRowObj.Content[0].Values.length===dates.length))))continue;const isSeries=-1!==["series","diffseries"].indexOf(tableRowObj.Type.toLowerCase());var tbodyRow=document.createElement("tr");if(tbody.appendChild(tbodyRow),$(tbodyRow).addClass(["rephrase-table-row",isSeries?"rephrase-table-data-row":"rephrase-table-heading-row"]),isSeries)tableRowObj.Settings=appendObjSettings(tableRowObj.Settings||{},tableObj.Settings||{}),$ru.createTableSeries(tbodyRow,tableRowObj);else{var tbodyTitleCell=document.createElement("td");$(tbodyTitleCell).addClass("h5"),tbodyTitleCell.setAttribute("colspan",dates.length+1),tbodyTitleCell.innerText=tableRowObj.Title||"",tbodyRow.appendChild(tbodyTitleCell)}}function onBtnClick(event){const thisBtn=event.target,tableParent=$(thisBtn).parent().parent(),otherBtn1=$(thisBtn).siblings()[0],otherBtn2=$(thisBtn).siblings()[1],isDiff=$(thisBtn).hasClass("rephrase-diff-table-button-show-diff"),isBaseline=$(thisBtn).hasClass("rephrase-diff-table-button-show-baseline"),btnType=isDiff?"diff":isBaseline?"baseline":"alternative";$(thisBtn).hasClass("hollow")?($(thisBtn).removeClass("hollow"),thisBtn.innerText=thisBtn.innerText.replace("Show","Hide"),toggleRows(tableParent,"show",btnType)):$(otherBtn1).hasClass("hollow")&&$(otherBtn2).hasClass("hollow")||($(thisBtn).addClass("hollow"),thisBtn.innerText=thisBtn.innerText.replace("Hide","Show"),toggleRows(tableParent,"hide",btnType))}function toggleRows(tableParent,toggleState,btnType){const rows="diff"===btnType?$(tableParent).find(".rephrase-diff-table-data-row-diff"):"baseline"===btnType?$(tableParent).find(".rephrase-diff-table-data-row-baseline"):$(tableParent).find(".rephrase-diff-table-data-row-alternative");for(var i=0;i<rows.length;i++){rows[i].style.display="hide"===toggleState?"none":""}}tableObj.Settings.DisplayRows.Diff||toggleRows(tableParent,"hide","diff"),tableObj.Settings.DisplayRows.Baseline||toggleRows(tableParent,"hide","baseline"),tableObj.Settings.DisplayRows.Alternative||toggleRows(tableParent,"hide","alternative")}function createTableSeries(tbodyRow,tableRowObj){const nDecimals=tableRowObj.Settings.NumDecimals||2,diffMethod=(tableRowObj.Settings.Method||"Difference").toLowerCase();var tbodyTitleCell=document.createElement("td");if($(tbodyTitleCell).addClass("rephrase-table-data-row-title"),tbodyTitleCell.innerText=tableRowObj.Title||"",tbodyRow.appendChild(tbodyTitleCell),"diffseries"===tableRowObj.Type.toLowerCase()){$(tbodyRow).addClass("rephrase-diff-table-data-row-title"),tbodyTitleCell.setAttribute("colspan",tableRowObj.Settings.Dates.length+1);var diffRow=document.createElement("tr");$(diffRow).addClass("rephrase-diff-table-data-row-diff");var diffRowTitleCell=document.createElement("td");$(diffRowTitleCell).addClass(["rephrase-table-data-row-title","rephrase-diff-table-data-row-diff-title"]),diffRowTitleCell.innerText=tableRowObj.Settings.RowTitles&&tableRowObj.Settings.RowTitles.Diff?tableRowObj.Settings.RowTitles.Diff:"Diff",diffRow.appendChild(diffRowTitleCell);var baselineRow=document.createElement("tr");$(baselineRow).addClass("rephrase-diff-table-data-row-baseline");var baselineRowTitleCell=document.createElement("td");$(baselineRowTitleCell).addClass(["rephrase-table-data-row-title","rephrase-diff-table-data-row-baseline-title"]),baselineRowTitleCell.innerText=tableRowObj.Settings.RowTitles&&tableRowObj.Settings.RowTitles.Baseline?tableRowObj.Settings.RowTitles.Baseline:"Baseline",baselineRow.appendChild(baselineRowTitleCell);var alternativeRow=document.createElement("tr");$(alternativeRow).addClass("rephrase-diff-table-data-row-alternative");var alternativeRowTitleCell=document.createElement("td");$(alternativeRowTitleCell).addClass(["rephrase-table-data-row-title","rephrase-diff-table-data-row-alternative-title"]),alternativeRowTitleCell.innerText=tableRowObj.Settings.RowTitles&&tableRowObj.Settings.RowTitles.Alternative?tableRowObj.Settings.RowTitles.Alternative:"Alternative",alternativeRow.appendChild(alternativeRowTitleCell);for(var baselineSeries="string"==typeof tableRowObj.Content[0]?$ru.databank.getSeriesContent(tableRowObj.Content[0]):tableRowObj.Content[0],alternativeSeries="string"==typeof tableRowObj.Content[1]?$ru.databank.getSeriesContent(tableRowObj.Content[1]):tableRowObj.Content[1],j=0;j<Math.max(baselineSeries.Values.length,alternativeSeries.Values.length);j++){const v1=baselineSeries.Values[j],v2=alternativeSeries.Values[j],vDiff="ratio"===diffMethod?v2/v1:"percent"===diffMethod?100*(v2-v1)/v1:v2-v1;var baselineDataCell=document.createElement("td");$(baselineDataCell).addClass(["rephrase-table-data-cell","rephrase-diff-table-data-cell-baseline"]),baselineDataCell.innerText=v1.toFixed(nDecimals),baselineRow.appendChild(baselineDataCell);var alternativeDataCell=document.createElement("td");$(alternativeDataCell).addClass(["rephrase-table-data-cell","rephrase-diff-table-data-cell-alternative"]),alternativeDataCell.innerText=v2.toFixed(nDecimals),alternativeRow.appendChild(alternativeDataCell);var diffDataCell=document.createElement("td");$(diffDataCell).addClass(["rephrase-table-data-cell","rephrase-diff-table-data-cell-diff"]),diffDataCell.innerText=vDiff.toFixed(nDecimals)+("percent"===diffMethod?"%":""),diffRow.appendChild(diffDataCell)}$(tbodyRow).after(baselineRow),$(baselineRow).after(alternativeRow),$(alternativeRow).after(diffRow)}else{"string"==typeof tableRowObj.Content&&(tableRowObj.Content=$ru.databank.getSeriesContent(tableRowObj.Content));for(j=0;j<tableRowObj.Content.Values.length;j++){const v=tableRowObj.Content.Values[j];var tbodyDataCell=document.createElement("td");$(tbodyDataCell).addClass("rephrase-table-data-cell"),tbodyDataCell.innerText=v.toFixed(nDecimals),tbodyRow.appendChild(tbodyDataCell)}}}function createGrid(parent,gridObj){var gridRowParent=document.createElement("div");if($(gridRowParent).addClass(["rephrase-grid","grid-y","grid-padding-y"]),parent.appendChild(gridRowParent),gridObj.Title){var gridTitle=document.createElement("h2");$(gridTitle).addClass("rephrase-grid-title"),gridTitle.innerText=gridObj.Title,gridRowParent.appendChild(gridTitle)}const nRows=gridObj.Settings.NumRows,nCols=gridObj.Settings.NumColumns;for(var i=0;i<nRows;i++){var gridRow=document.createElement("div");$(gridRow).addClass(["cell","shrink"]),gridRowParent.appendChild(gridRow);var gridColParent=document.createElement("div");$(gridColParent).addClass(["grid-x","grid-padding-x"]),gridRow.appendChild(gridColParent);for(let j=0;j<nCols;j++){const contentIndex=nCols*i+j;var gridCol=document.createElement("div");$(gridCol).addClass(["cell","auto"]),gridColParent.appendChild(gridCol);const gridElementObj=gridObj.Content[contentIndex];$ru.addReportElement(gridCol,gridElementObj,gridObj.Settings)}}}function createWrapper(parent,wrapperObj){for(let i=0;i<wrapperObj.Content.length;i++){const elementObj=wrapperObj.Content[i];$ru.addReportElement(parent,elementObj,wrapperObj.Settings)}}function addReportElement(parentElement,elementObj,parentObjSettings){if(!elementObj||"object"!=typeof elementObj||!elementObj.hasOwnProperty("Type"))return{};switch(elementObj.Settings=appendObjSettings(elementObj.Settings||{},parentObjSettings||{}),elementObj.Type.toLowerCase()){case"chart":$ru.createChart(parentElement,elementObj);break;case"table":$ru.createTable(parentElement,elementObj);break;case"matrix":$ru.createMatrix(parentElement,elementObj);break;case"grid":$ru.createGrid(parentElement,elementObj);break;case"text":$ru.createTextBlock(parentElement,elementObj);break;case"wrapper":$ru.createWrapper(parentElement,elementObj);break;case"pagebreak":$ru.addPageBreak(parentElement,elementObj);break;default:console.log("Unknown report element")}}function appendObjSettings(objSettings,parentSettings){const parentKeys=Object.keys(parentSettings);for(let i=0;i<parentKeys.length;i++){const key=parentKeys[i];"class"!==key.toLowerCase()&&(objSettings.hasOwnProperty(key)||(objSettings[key]=parentSettings[key]))}return objSettings}var $defaultSettings={};$(document).foundation(),function(){if(document.title=$report.Title||"",$report.Settings.Class&&("string"==typeof $report.Settings.Class||$report.Settings.Class instanceof Array)){var reportDiv=document.querySelector(".report-content");$(reportDiv).addClass($report.Settings.Class)}var headerDiv=document.querySelector(".report-header");if($report.hasOwnProperty("Title")&&null!==$report.Title){var headerTextDiv=headerDiv.querySelector(".header-text");headerTextDiv.querySelector(".title").innerText=$report.Title||"",headerTextDiv.querySelector(".subtitle").innerText=$report.Settings.Subtitle||"";var leftLogoDiv=headerDiv.querySelector(".left-logo"),rightLogoDiv=headerDiv.querySelector(".right-logo");const hiddenLogoImg=document.querySelector(".report-default-logo");if(!$report.Settings.hasOwnProperty("Logo")){const imgSrc=hiddenLogoImg.getAttribute("src")||"";$report.Settings.Logo={Path:imgSrc,Position:"Left"}}hiddenLogoImg.parentNode.removeChild(hiddenLogoImg);var logo=$report.Settings.Logo||[];"object"!=typeof logo||logo instanceof Array||(logo=[logo]);for(var hasLeft,hasRight=!1,i=0;i<logo.length;i++){const lg=logo[i];"object"==typeof lg&&lg.hasOwnProperty("Path")&&lg.Path&&lg.hasOwnProperty("Position")&&"None"!==lg.Position&&("left"===lg.Position.toLowerCase()&&(leftLogoDiv.innerHTML='<img class="left-logo-img" src="'+lg.Path+'" alt="logo"></img>',hasLeft=!0),"right"===lg.Position.toLowerCase()&&(rightLogoDiv.innerHTML='<img class="right-logo-img" src="'+lg.Path+'" alt="logo"></img>',hasRight=!0))}hasLeft||(leftLogoDiv.style.display="none"),hasRight||(rightLogoDiv.style.display="none")}else;var footerDiv=document.querySelector(".report-footer");$report.Settings.hasOwnProperty("Footer")&&null!==$report.Settings.Footer?footerDiv.querySelector(".footer-text").innerText=$report.Settings.Footer||"":footerDiv.style.display="none";var bodyDiv=document.querySelector(".report-body");for(let i=0;i<$report.Content.length;i++){const elementObj=$report.Content[i];$ru.addReportElement(bodyDiv,elementObj,$report.Settings)}}();